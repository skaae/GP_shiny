{
    "contents" : "% !Rnw root = ../master.Rnw\n% includes description of data and generation of the table which shows an overview\n% of the studies considered for inclusion\n% Also has code for generation of more detailed description of included data\n<<data_overview_tab,echo=FALSE,results=hide>>=\n# Loads clinical data and prints overview table\n# source(\"table/create_data_overview_table.R\")\n# \n# #create table which shows overview of studies\n# tab.overview.studies.out <- create_tab_overview(file.clinical)\n# @\n# <<tab_overview,echo=FALSE,results=TEX>>=\n# print(xtable(tab.overview.studies.out,\n#              caption=\"-----\",\n#              label=\"tab:data_overview\"\n# ),\n#       size=\"tiny\",\n#       booktabs=TRUE,\n#       caption.placement=\"top\",\n#       include.rownames=FALSE)\n# @\n\n<<describe_included_data,echo=FALSE,results=hide>>=\n\n\ninc_clin <- function(line){\n  # Defines inclusion criteria for data\n  size     <- !is.na(line[\"size\"])    #size in cm\n  grade     <- !is.na(line[\"grade\"])   #grade\n  age       <- !is.na(line[\"age\"])\n  node      <- !is.na(line[\"node\"])\n  er        <- !is.na(line[\"er\"])\n  er.Expr   <- !is.na(line[\"er.Expr\"])\n  her2      <- !is.na(line[\"her2\"])\n  her2.Expr <- !is.na(line[\"her2.Expr\"])\n  inc <- size & grade & age & node & (er | er.Expr) & (her2 | her2.Expr)\n}\n\ncreate_overview_included_tab <- function(data){\n  # creates table with overview of included data\n  # Table includes\n  # Age (years), size, Node, Grade\n  add_par <- function(arg1,arg2){\n    paste(arg1, paste0(\"(\",arg2,\")\"))\n  }\n  bold_rows <- c(1,6,12,18,24,29,34,39)\n  \n  age.median <- round(median(data$age,na.rm=T),0)\n  age.range  <-  paste0(round(range(data$age,na.rm=T),0),collapse=\"-\")\n  tab.median <- c(\"Median\",add_par(age.median,age.range))\n  tab.mean   <- c(\"Mean\", add_par(round(mean(data$age,na.rm=T),0),\n                                  paste0(\"$\\\\pm$\",round(sd(data$age,na.rm=T),2))))\n  tab.na    <- c(\"No age inf.\",sum(is.na(data$age)))\n  tab.age    <- rbind(c(\"Age (years)\",\"\"),tab.median,tab.mean,tab.na)\n  \n  size <- cut(data$size, br=c(-Inf,1.5,2.5,Inf),\n              labels = c(\"<=1.5\",\"(1.5-2.5]\",\">2.5\"))\n  size <- table(size)\n  tab.size <- cbind(names(size),as.numeric(size))\n  tab.size <- rbind(tab.size,c(\"No size inf.\", sum(is.na(data$size))))\n  tab.size <- rbind(c(\"\",\"\"),c(\"Size (cm)\",\"BOLDPatients\"),tab.size)\n  \n  node <- cut(data$node, br=c(-Inf,0,3,Inf),\n              labels = c(\"0\",\"1-3\",\">3\"))\n  node <- table(node)\n  tab.node <- cbind(names(node),as.numeric(node))\n  tab.node <- rbind(tab.node, c(\"No Node inf.\", sum(is.na(data$node))))\n  tab.node <- rbind(c(\"\",\"\"),c(\"Node\",\"\"),tab.node)\n  \n  grade <- table(data$grade)\n  tab.grade <- cbind(names(grade),as.numeric(grade))\n  tab.grade <- rbind(c(\"\",\"\"),c(\"Grade\",\"\"),tab.grade)\n  tab.grade <- rbind(tab.grade, c(\"No Grade inf.\", sum(is.na(data$grade))))\n  \n  \n  er <- table(data$er.combined)\n  tab.er <- cbind(c(\"Negative\",\"Positive\"),as.numeric(er))\n  tab.er <- rbind(c(\"\",\"\"),c(\"Estrogen Receptor status\",\"\"),tab.er)\n  tab.er <- rbind(tab.er, c(\"No ER inf.\", sum(is.na(data$er.combined))))\n  \n  \n  her2 <- table(data$her2.combined)\n  tab.her2 <- cbind(c(\"Negative\",\"Positive\"),as.numeric(her2))\n  tab.her2 <- rbind(c(\"\",\"\"),c(\"HER2 status\",\"\"),tab.her2)\n  tab.her2 <- rbind(tab.her2, c(\"No HER2 inf.\", sum(is.na(data$her2.combined))))\n  \n  pgr <- table(data$pgr.combined)\n  tab.pgr <- cbind(c(\"Negative\",\"Positive\"),as.numeric(pgr))\n  tab.pgr <- rbind(c(\"\",\"\"),c(\"Progesterone receptor status\",\"\"),tab.pgr)\n  tab.pgr <- rbind(tab.pgr, c(\"No PR inf\", sum(is.na(data$pgr.combined))))\n  \n  \n  treatment_any <- table(data$treatment_any)\n  tab.treatment_any <- cbind(c(\"Treatment\",\"No Treatment\"),as.numeric(treatment_any))\n  tab.treatment_any <- rbind(c(\"\",\"\"),c(\"Treatment\",\"\"),tab.treatment_any)\n  tab.treatment_any <- rbind(tab.treatment_any, c(\"No Treatment data inf.\", sum(is.na(data$treatment_any))))\n  \n  tab.out <- rbind(tab.age,tab.size,tab.node,tab.grade,tab.er,tab.her2,tab.pgr,tab.treatment_any)\n  row.names(tab.out) <- 1:nrow(tab.out)\n  tab.out[bold_rows,1] <- paste0('BOLD',tab.out[bold_rows,1])\n  return(tab.out)\n\n}\n\n#helper function for creating bold rows\nbold.somerows <-  function(x) gsub('BOLD(.*)',paste0('\\\\\\\\textbf{\\\\1','}'),x)\n\n\n\n# create table which shows overview of included data\ntab.clin.out <- create_overview_included_tab(tab.clinical)\n\nc_and_p <- function(frac,total) paste0(frac,\" (\",round(frac / total,3),\")\")\n\n\n has.t.os <- c_and_p(sum(!is.na(tab.clinical$t.os)), nrow(tab.clinical))   \n has.t.rfs <- c_and_p(nrow(tab.clinical)- sum(!is.na(tab.clinical$t.os)),nrow(tab.clinical))\n\nhas.ihc.er   <-  c_and_p(sum(!is.na(tab.clinical$er)),sum(!is.na(tab.clinical$er.combined)))\nhas.ihc.her2   <-  c_and_p(sum(!is.na(tab.clinical$her2)),sum(!is.na(tab.clinical$her2.combined)))\nhas.ihc.pgr   <-  c_and_p(sum(!is.na(tab.clinical$pgr)),sum(!is.na(tab.clinical$pgr.combined)))\n@\n\\section{Overview of included data}\nTable \\ref{tab:combined_data} shows an overview of data collected by \\cite{HaibeKains:2012gp}, \\cite{Curtis:2012il} \nand \\cite{Koboldt:2012fy}. In table Table \\ref{tab:combined_data} all entires \nexcept METABRIC and TCGA has been collected by \\cite{HaibeKains:2012gp}.\nBy applying the inclusion criteria from section \\ref{sec:methods_data_collection} \n\\pageref{sec:methods_data_collection} \\Sexpr{nrow(tab.clinical)} patients was \nincluded in the study. Of these patients\\Sexpr{has.t.os} had survival time given \nas overall survival and \\Sexpr{has.t.rfs} has survival given as recurrnce free survival.\n\nTable \\ref{tab:data_included_overview} shows basic statistics of the included data. \nThe total number of included patients is \\Sexpr{nrow(tab.clinical)}.  The data \nin the table does generally not sum to \\Sexpr{nrow(tab.clinical)} because the\ntable \\ref{tab:data_included_overview} was created using the raw data containing \nat most \\Sexpr{nas_cutoff} per sample. \n\nFor ER receptor \\Sexpr{has.ihc.er} patients had ER receptor status determined by immunochemistry\nand fo  HER2 receptor the status was determined with immunochemistry for \\Sexpr{has.ihc.her2} patients\nand for PR \\Sexpr{has.ihc.pgr}\n\nNote from table \\ref{tab:data_included_overview} the large fraction of patients \nhas no PGR and no HER2 information.\n\n%haibe kains et.al data collection\n\\SweaveInput{../table/table_combined_data.Rnw}\n\n<<describe_included_tab,echo=FALSE,results=tex>>=\nprint(xtable(tab.clin.out,\n             caption=paste0(\"Basic statistic of data used in clinical analysis,  n=\",nrow(tab.clinical)),\n             label=\"tab:data_included_overview\",\n             align=\"lll\"\n),\n      size=\"tiny\",\n      booktabs=TRUE,\n      caption.placement=\"top\",\n      include.rownames=FALSE,\n      include.colnames=FALSE,\n      sanitize.text.function =  bold.somerows,\n      ) \n@\n\n\\FloatBarrier\n\n",
    "created" : 1387282707567.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "961527649",
    "id" : "2F89C1B1",
    "lastKnownWriteTime" : 1387458127,
    "path" : "~/Documents/Speciale/breast_cancer/documents/results_data_overview.Rnw",
    "project_path" : null,
    "properties" : {
    },
    "source_on_save" : false,
    "type" : "sweave"
}